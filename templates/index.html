<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Habit Tracker</title>
</head>

<body>
    <h1>Habit Tracker</h1>

    <form action="{{ url_for('add') }}" method="post">
        <input type="text" name="name" placeholder="New Habit" />
        <button type="submit">Add Habit</button>
    </form>

    <h2>Your Habits</h2>
    {% if habits %}
    <ul>
        {% for habit in habits %}
        {% set done_today = (habit['last_done'] == now_date) %}
        <li>
            <strong>{{ habit["name"] }}</strong>
            (Streak: {{ habit["streak"] }} | Best: {{ habit["best_streak"] }})
            {% set done_today = (habit['last_done'] == now_date) %}
            {% if done_today %}
            <span style="color: green; margin-left:6px;">(Done today)</span>
            {% else %}
            <form action="{{ url_for('mark_done', habit_id=habit['id']) }}" method="post"
                style="display:inline; margin-left:8px;">
                <button type="submit">Mark Done</button>
            </form>
            {% endif %}
            <form action="{{ url_for('edit', habit_id=habit['id']) }}" method="post"
                style="display:inline; margin-left:8px;">
                <input type="text" name="name" value="{{ habit['name'] }}" />
                <button type="submit">Edit</button>
            </form>
            <form action="{{ url_for('delete', habit_id=habit['id']) }}" method="post" style="display:inline;">
                <button type="submit">Delete</button>
            </form>
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>No habits yet. Add one above!</p>
    {% endif %}
</body>

</html>